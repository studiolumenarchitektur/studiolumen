<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Architekturbüro ebbe&flut</title>
  <style>
    body {
      margin: 0;
      background: #fff;
      font-family: 'Inter', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .logo-container {
      position: relative;
      width: 600px;
      height: 300px;
      cursor: pointer;
    }

    svg {
      width: 100%;
      height: 100%;
    }

    #hoverImage {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 5s ease;
      object-fit: contain;
      z-index: 10;
      pointer-events: none;
    }

    #hoverImage.visible {
      opacity: 0.1;
    }
  </style>
</head>
<body>

<div class="logo-container" id="logoContainer">
  <svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
    <path id="wavePath" stroke="#002f6c" stroke-width="12" fill="none" stroke-linecap="round" />
    <text x="300" y="60" text-anchor="middle" font-size="18" fill="#002f6c">ARCHITEKTURBÜRO</text>
    <text x="120" y="140" font-size="64" fill="#002f6c">ebbe</text>
    <text x="290" y="140" font-size="64" fill="#002f6c">&amp;</text>
    <text x="290" y="210" font-size="64" fill="#002f6c">flut</text>
  </svg>
  <img src="bruno.png" id="hoverImage" alt="" />
</div>

<script>
  const waveXStart = 60;
  const waveXEnd = 330;
  const waveWidth = waveXEnd - waveXStart;
  const waveYOffset = 230;

  const path = document.getElementById("wavePath");
  const logoLink = document.getElementById("logoLink");
  const hoverImage = document.getElementById("hoverImage");
  const logoContainer = document.querySelector('.logo-container');

  const baseAmplitude = 20;
  const baseFrequency = 3;
  const segments = 150;

  let t = 0;
  let tSpeed = 0.02;

  // NEU: Impulswellen pro Segment
  let impulses = new Array(segments + 1).fill(0);
  let impulseVel = new Array(segments + 1).fill(0);
  let impulseDecay = 0.95;
  let springStrength = 0.1;

  let shockOrigin = null;
  let shockTimer = 0;
  const shockDuration = 300;

  function easeInOut(x) {
    return x < 0.5
      ? 2 * x * x
      : 1 - Math.pow(-2 * x + 2, 2) / 2;
  }

  function animate() {
    const points = [];
    for (let i = 0; i <= segments; i++) {
      const x = waveXStart + waveWidth * i / segments;

      // Sinusbasis
      const yBase = baseAmplitude * Math.sin((2 * Math.PI * baseFrequency * (x - waveXStart) / waveWidth) + t);

      // Klick-Schockeffekt
      let localFreq = baseFrequency;
      let localAmp = baseAmplitude;
      if (shockOrigin !== null) {
        const dist = Math.abs(x - shockOrigin);
        const spread = waveWidth / 3;
        const intensity = Math.max(0, 1 - dist / spread);
        const progress = shockTimer / shockDuration;
        const scale = easeInOut(progress <= 0.5 ? progress * 2 : 2 - progress * 2);
        localFreq = baseFrequency - scale * 1 * intensity;
        localAmp = baseAmplitude + scale * 40 * intensity;
      }

      // Impuls-basierte Schwingung addieren
      const yImpulse = impulses[i] || 0;

      const y = waveYOffset + localAmp * Math.sin((2 * Math.PI * localFreq * (x - waveXStart) / waveWidth) + t) + yImpulse;

      points.push(`${x},${y}`);
    }

    path.setAttribute("d", "M " + points.join(" L "));

    // Zeitverlauf
    if (shockOrigin !== null && shockTimer < shockDuration / 2) {
      t += tSpeed * 2.2;
    } else {
      t += tSpeed;
    }

    if (shockOrigin !== null) {
      shockTimer++;
      if (shockTimer > shockDuration) {
        shockOrigin = null;
        shockTimer = 0;
      }
    }

    // Physikalisches Abklingen der Impulse
    for (let i = 0; i <= segments; i++) {
      const displacement = -impulses[i];
      const force = springStrength * displacement;
      impulseVel[i] += force;
      impulseVel[i] *= impulseDecay;
      impulses[i] += impulseVel[i];
    }

    requestAnimationFrame(animate);
  }

  animate();

  logoContainer.addEventListener('mousemove', (e) => {
    const rect = logoContainer.getBoundingClientRect();
    const x = e.clientX - rect.left;
    if (x >= waveXStart && x <= waveXEnd) {
      const index = Math.floor((x - waveXStart) / waveWidth * segments);
      if (index >= 0 && index <= segments) {
        // sanfte kleine Ablenkung
        impulseVel[index] -= 4;
      }
    }
  });

  logoContainer.addEventListener('mouseenter', () => {
    hoverImage.classList.add('visible');
  });

  logoContainer.addEventListener('mouseleave', () => {
    hoverImage.classList.remove('visible');
  });

  logoLink.addEventListener('click', function (e) {
    e.preventDefault();
    const rect = logoLink.getBoundingClientRect();
    let clickX = e.clientX - rect.left;
    if (clickX < waveXStart) clickX = waveXStart;
    if (clickX > waveXEnd) clickX = waveXEnd;
    shockOrigin = clickX;
    shockTimer = 0;

    hoverImage.style.transition = `opacity ${shockDuration / 60}s ease`;
    hoverImage.style.opacity = '1';

    setTimeout(() => {
      window.location.href = logoLink.href;
    }, (shockDuration / 60) * 1000);
  });
</script>
