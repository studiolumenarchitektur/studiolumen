<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>HOAI-Angebot mit LPH-Auswahl & Exaktberechnung</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #f7f7f7; }
    .section { background: #fff; padding: 1em; border-radius: 5px; margin-bottom: 2em; border: 1px solid #ccc; }
    label { font-weight: bold; display: block; margin-top: 1em; }
    select, input[type="number"], input[type="text"] { width: 100%; padding: 0.5em; margin-top: 0.2em; }
    .lph-row { display: flex; align-items: center; margin-top: 0.5em; }
    .lph-row label { flex: 1; }
    .lph-row input[type="number"] { width: 60px; margin-left: 1em; }
  </style>
</head>
<body>

<h1>HOAI-Angebot mit exakter Tabelle & LPH-Auswahl</h1>

<div class="section">
  <h2>1. Angaben</h2>
  <label for="bgf">Bruttogrundfläche (BGF) in m²:</label>
  <input type="number" id="bgf" value="100">

  <label for="bauweise">Bauweise:</label>
  <select id="bauweise">
    <option value="1800">Einfach</option>
    <option value="2200" selected>Mittel</option>
    <option value="2800">Hochwertig</option>
  </select>

  <label for="honorarzone">Honorarzone:</label>
  <select id="honorarzone">
    <option value="1">Zone I</option>
    <option value="2" selected>Zone II</option>
    <option value="3">Zone III</option>
    <option value="4">Zone IV</option>
    <option value="5">Zone V</option>
  </select>

  <label for="satz">Honorarsatz:</label>
  <select id="satz">
    <option value="min">Mindestsatz</option>
    <option value="mittel" selected>Mittelsatz</option>
    <option value="max">Höchstsatz</option>
  </select>

  <h3>Leistungsphasen (LPH) auswählen:</h3>
  <div id="lph-container"></div>
</div>

<div class="section">
  <h2>2. Ergebnis</h2>
  <p><strong>Anrechenbare Kosten:</strong> <span id="kosten">–</span> €</p>
  <p><strong>Grundleistung (100 %):</strong> <span id="grundhonorar">–</span> €</p>
  <p><strong>LPH-Gesamtanteil:</strong> <span id="lphsumme">–</span> %</p>
  <p><strong>Honorar (nach Auswahl) + NK (5 %):</strong> <span id="gesamt">–</span> €</p>
</div>

<script>
const hoaiTabelle = {{
  "1": [83, 97],
  "2": [101, 119],
  "3": [117, 139],
  "4": [135, 160],
  "5": [152, 180]
}};

const lphDaten = [
  {{ nummer: 1, name: "Grundlagenermittlung", standard: 2 }},
  {{ nummer: 2, name: "Vorplanung", standard: 7 }},
  {{ nummer: 3, name: "Entwurfsplanung", standard: 15 }},
  {{ nummer: 4, name: "Genehmigungsplanung", standard: 3 }},
  {{ nummer: 5, name: "Ausführungsplanung", standard: 38 }},
  {{ nummer: 6, name: "Vorbereitung der Vergabe", standard: 10 }},
  {{ nummer: 7, name: "Mitwirkung bei der Vergabe", standard: 4 }},
  {{ nummer: 8, name: "Objektüberwachung", standard: 18 }},
  {{ nummer: 9, name: "Objektbetreuung", standard: 3 }}
];

const lphContainer = document.getElementById("lph-container");
lphDaten.forEach(lph => {{
  const div = document.createElement("div");
  div.className = "lph-row";
  div.innerHTML = `
    <input type="checkbox" id="lph${{lph.nummer}}" checked>
    <label for="lph${{lph.nummer}}">LPH ${{lph.nummer}}: ${{lph.name}}</label>
    <input type="number" id="pct${{lph.nummer}}" value="${{lph.standard}}" min="0" max="100"> %
  `;
  lphContainer.appendChild(div);
}});

function berechne() {{
  const bgf = parseFloat(document.getElementById("bgf").value);
  const standard = parseFloat(document.getElementById("bauweise").value);
  const zone = document.getElementById("honorarzone").value;
  const satz = document.getElementById("satz").value;

  const anrKosten = bgf * standard;
  document.getElementById("kosten").textContent = anrKosten.toLocaleString("de-DE");

  const [min, max] = hoaiTabelle[zone];
  let proTsd = min;
  if (satz === "mittel") proTsd = (min + max) / 2;
  if (satz === "max") proTsd = max;

  const grund = anrKosten / 1000 * proTsd;
  document.getElementById("grundhonorar").textContent = grund.toLocaleString("de-DE", {{minimumFractionDigits: 2}});

  let lphSum = 0;
  lphDaten.forEach(lph => {{
    const cb = document.getElementById(`lph${{lph.nummer}}`);
    const pct = parseFloat(document.getElementById(`pct${{lph.nummer}}`).value || 0);
    if (cb.checked) {{
      lphSum += pct;
    }}
  }});
  document.getElementById("lphsumme").textContent = lphSum.toFixed(2);

  const teilhonorar = grund * (lphSum / 100);
  const nk = teilhonorar * 0.05;
  const gesamt = teilhonorar + nk;
  document.getElementById("gesamt").textContent = gesamt.toLocaleString("de-DE", {{minimumFractionDigits: 2}});
}}

document.querySelectorAll("input, select").forEach(el => {{
  el.addEventListener("input", berechne);
}});
berechne();
</script>

</body>
</html>
